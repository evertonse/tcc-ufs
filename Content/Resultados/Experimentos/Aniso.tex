\section{Experimento BRDF Anisotrópica baseado em Kajiya-Kay (1989)}

A BRDF de especularidade anisotrópica, baseada no trabalho seminal de @@REF Kajiya-Kay de 1989, modela a reflexão especular em superfícies com características direcionais, como tecidos e cabelos. Esta abordagem captura de forma sofisticada a distribuição de luz em superfícies com orientação preferencial. As equações que descrevem esse experimento se encontram em \autoref{fig-kajiya-eqlang-latex}. O código fonte de entrada para o compilador está dividido em duas partes, parte 1 está no \autoref{cod-kajiya-eqlang} e a segunda parte está em \autoref{cod-kajiya-eqlang-pt2}. A redenrização de um objeto 3D usando essa BRDF esta em \autoref{fig-kajiya-eqlang}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Representação em documento \LaTeX{}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[H]
    \caption{\label{fig-kajiya-eqlang-latex} \small Equações da BRDF do experimento Kajiya-Kay em documento \LaTeX{}.}
    \begin{center}
        % \includegraphics[scale=1.1,width=\textwidth]{./Imagens/brdfs/aniso.pdf}
        \includegraphics[scale=0.92]{./Imagens/brdfs/aniso.pdf}
    \end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Visualização do Resultado}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[H]
    \caption{\small{Distribuição de Reflexão Especular e Difusa da BRDF Anisotrópica: Kajiya-Kay (1989)}}\label{fig-kajiya-eqlang}
\minipage{0.48\textwidth}
    \vspace{42px}
  \includegraphics[width=\linewidth]{./Imagens/brdfs/aniso-3D-plot}
    % \caption{\small{(a)}}\label{fig:awesome_image1}
    % \vspace{0.1px}
    \legend{ \small (a) 3D \textit{plot}}
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{./Imagens/brdfs/aniso-polar-plot.png}
    \legend{ \small (b) \textit{Polar plot}}
    % \caption{\small{(b)}}\label{fig:awesome_image1}
\endminipage\hfill
\end{figure}

\begin{figure}[H]
    % \caption{\small{Objetos 3D renderizado pelo código GLSL gerado o experimento BRDF Anisotrópica: Kajiya-Kay (1989)}}\label{fig-kajiya-eqlang}
    \caption{\small{Objetos 3D renderizado no experimento BRDF Anisotrópica: Kajiya-Kay (1989)}}\label{fig-kajiya-eqlang}
\minipage{0.32\textwidth}
  \includegraphics[width=\linewidth]{./Imagens/brdfs/aniso-teapot.png}
    % \caption{\small{(a)}}\label{fig:awesome_image1}
    \legend{ \small (a) \textit{Teapot}}
\endminipage\hfill
\minipage{0.32\textwidth}
  \includegraphics[width=\linewidth]{./Imagens/brdfs/aniso-dragon.png}
    \legend{ \small (b) Dragão de Stanford}
    % \caption{\small{(b)}}\label{fig:awesome_image1}
\endminipage\hfill
\minipage{0.32\textwidth}%
  \includegraphics[width=\linewidth]{./Imagens/brdfs/aniso-goblin.png}
    \legend{ \small (c) Goblin}
    % \caption{\small{(c)}}\label{fig:awesome_image1}
\endminipage
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Código GLSL Gerado}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{codigo}[H]
    \caption{\small Saida do compilador, código GLSL da BRDF do experimento baseado em Kajiya-Kay (parte 1). }
    \label{cod-kajiya-eqlang-declarations}
\begin{lstlisting}[language=C, inputencoding=utf8]
analytic
::begin parameters
# [type] [name] [min val] [max val] [default val]
::end parameters
::begin shader

//////////// START OF BUILTINS DECLARTION ////////////
vec3  var_0_vec_h;
vec3  var_3_vec_n;
float var_10_theta_h;
float var_11_theta_d;
float var_1_pi;
float var_2_epsilon;
vec3  var_4_vec_omega_i;
float var_5_theta_i;
float var_6_phi_i;
vec3  var_7_vec_omega_o;
float var_8_theta_o;
float var_9_phi_o;
//////////// END OF BUILTINS DECLARTION ////////////

//////////// START OF USER DECLARED ////////////
float var_12_text_roughness;
float var_13_text_glossiness;
vec3  var_16_X;
vec3  var_17_Y;
vec3  var_18_T;
vec3  var_19_L;
float var_20_text_sinAngleLT;
float var_21_text_spec;
float var_22_f;
//////////// END OF USER DECLARED ////////////
\end{lstlisting}
\end{codigo}

\begin{codigo}[H]
    \caption{\small Saida do compilador, código GLSL da BRDF do experimento baseado em Kajiya-Kay (parte 2). }
    \label{cod-kajiya-eqlang}
\begin{lstlisting}[language=C, inputencoding=utf8]
//////////// START FUNCTIONS DECLARATIONS ////////////
vec3 var_14_text_normalize(vec3 var_15_vec_u) {
    return (var_15_vec_u/sqrt(dot(var_15_vec_u,var_15_vec_u)));
}
//////////// END FUNCTIONS DECLARATIONS ////////////
vec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y) {

//////////// START OF BUILTINS INITIALIZATION ////////////
  var_0_vec_h = normalize(L + V);
  var_3_vec_n = normalize(N);
  var_1_pi = 3.141592653589793;
  var_2_epsilon = 1.192092896e-07;
  var_4_vec_omega_i = L;
  var_5_theta_i = atan(var_4_vec_omega_i.y, var_4_vec_omega_i.x);
  var_6_phi_i = atan(sqrt(var_4_vec_omega_i.y * var_4_vec_omega_i.y +
                          var_4_vec_omega_i.x * var_4_vec_omega_i.x),
                     var_4_vec_omega_i.z);
  var_7_vec_omega_o = V;
  var_8_theta_o = atan(var_7_vec_omega_o.y, var_7_vec_omega_o.x);
  var_9_phi_o = atan(sqrt(var_7_vec_omega_o.y * var_7_vec_omega_o.y +
                          var_7_vec_omega_o.x * var_7_vec_omega_o.x),
                     var_7_vec_omega_o.z);
  var_10_theta_h = acos(dot(var_0_vec_h, N));
  var_11_theta_d = acos(dot(var_0_vec_h, var_4_vec_omega_i));
//////////// END OF BUILTINS INITIALIZATION ////////////

  var_12_text_roughness = 0.1;
  var_13_text_glossiness = ((1.0 / var_12_text_roughness));
  var_16_X = var_14_text_normalize(cross(vec3(0.0, 1.0, 0.0), var_3_vec_n));
  var_17_Y = var_14_text_normalize(cross(var_3_vec_n, var_16_X));
  var_18_T = var_17_Y;
  var_19_L = var_4_vec_omega_i;
  var_20_text_sinAngleLT =
      sqrt(((1.0 - (((dot(var_4_vec_omega_i, var_18_T)) *
                     (dot(var_4_vec_omega_i, var_18_T)))))));
  var_21_text_spec =
      pow(((((var_20_text_sinAngleLT *
              sqrt(((1.0 - (((dot(var_7_vec_omega_o, var_18_T)) *
                             (dot(var_7_vec_omega_o, var_18_T))))))))) -
            (((dot(var_4_vec_omega_i, var_18_T)) *
              (dot(var_7_vec_omega_o, var_18_T)))))),
          var_13_text_glossiness);
  var_22_f = var_21_text_spec;

  return vec3(var_22_f);
}

\end{lstlisting}
\end{codigo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Código Fonte em \texttt{EquationLang}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{codigo}[H]
    \caption{\small Código fonte da BRDF do experimento Kajiya-Kay (parte 1).}
    \label{cod-kajiya-eqlang}
\begin{lstlisting}[language=tex, frame=none, inputencoding=utf8]
Disney Aniso Specular - based on Kajiya-Kay 1989

\begin{equation}
  \text{normalize}(\vec{u}) = \frac{\vec{u}}{\sqrt{\vec{u} \cdot \vec{u}}}
\end{equation}

Tangent vector:
\begin{equation}
   X = \text{normalize}(\vec{0,1,0} \times \vec{n})
\end{equation}

Bitangent vector:
\begin{equation}
   Y = \text{normalize}(\vec{n} \times X)
\end{equation}

\begin{equation}
    T = Y
\end{equation}

\begin{equation}
    L = \vec{\omega_i}
\end{equation}
\end{lstlisting}
\end{codigo}

\begin{codigo}[H]
    \caption{\small Código fonte da BRDF do experimento Kajiya-Kay (parte 2).}
    \label{cod-kajiya-eqlang-pt2}
\begin{lstlisting}[language=tex, frame=none, inputencoding=utf8]

\begin{equation}
\text{roughness} =  0.1
\end{equation}

\begin{equation}
    \text{glossiness} = (1/\text{roughness})
\end{equation}

\begin{equation}
    \text{sinAngleLT} = \sqrt{(1 - ((\vec{\omega_i} \cdot T) * (\vec{\omega_i} \cdot T)))}
\end{equation}

\begin{equation}
\text{spec} = ((\text{sinAngleLT} \cdot \sqrt(1 - ((\vec \omega_o \cdot T) \cdot (\vec \omega_o \cdot T))))
                  - ((\vec{\omega_i} \cdot T) \cdot (\vec \omega_o \cdot T)))^ \text{glossiness}
\end{equation}

\begin{equation}
f = \text{spec}
\end{equation}
\end{lstlisting}
\end{codigo}
